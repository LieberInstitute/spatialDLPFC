Loading LIBD module for spagcn/1.2.0
Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
Trying to set attribute `.obs` of view, copying.
Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Continuing with sample Br6423_post...
Calculateing adj matrix using histology image...
Var of c0,c1,c2 =  285.1424413254478 468.6779270693965 230.90150903139826
Var of x,y,z =  21856166.947707184 23825892.488059603 23825892.488059606
Run 1: l [0.01, 1000], p [0.0, 24.757737836894183]
Run 2: l [0.01, 500.005], p [0.0, 3.5511789321899414]
Run 3: l [250.0075, 500.005], p [0.41456401348114014, 3.5511789321899414]
Run 4: l [250.0075, 375.00625], p [0.41456401348114014, 1.5064289569854736]
Run 5: l [250.0075, 312.50687500000004], p [0.41456401348114014, 0.8562941551208496]
Run 6: l [250.0075, 281.2571875], p [0.41456401348114014, 0.6114087104797363]
recommended l =  265.63234375
Start at res =  0.7 step =  0.1
Initializing cluster centers with louvain, resolution =  0.7
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  0.7 Num of clusters =  4
Initializing cluster centers with louvain, resolution =  0.7999999999999999
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  0.7999999999999999 Num of clusters =  5
Res changed to 0.7999999999999999
Initializing cluster centers with louvain, resolution =  0.8999999999999999
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  0.8999999999999999 Num of clusters =  6
Res changed to 0.8999999999999999
Initializing cluster centers with louvain, resolution =  0.9999999999999999
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  0.9999999999999999 Num of clusters =  6
Res changed to 0.9999999999999999
Initializing cluster centers with louvain, resolution =  1.0999999999999999
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  1.0999999999999999 Num of clusters =  6
Res changed to 1.0999999999999999
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  1.2 Num of clusters =  7
recommended res =  1.2
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Initializing cluster centers with louvain, resolution =  1.2
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [1.4142135381698608, 17.0880069732666], num_nbr [1.0, 394.1320939334638]
Calculateing adj matrix using xy only...
Run 2: radius [1.4142135381698608, 9.251110255718231], num_nbr [1.0, 127.12818003913894]
Calculateing adj matrix using xy only...
Run 3: radius [1.4142135381698608, 5.332661896944046], num_nbr [1.0, 43.1908023483366]
Calculateing adj matrix using xy only...
Run 4: radius [1.4142135381698608, 3.3734377175569534], num_nbr [1.0, 20.407045009784735]
Calculateing adj matrix using xy only...
Run 5: radius [2.393825627863407, 3.3734377175569534], num_nbr [8.833659491193737, 20.407045009784735]
Calculateing adj matrix using xy only...
recommended radius =  2.8836316727101803 num_nbr=12.691780821917808
radius= 2.8836316727101803 average number of neighbors for each spot is 12.691780821917808
 Cluster 0 has neighbors:
Dmain  1 :  999
Dmain  5 :  278
Warning: lowering "min_in_group_fraction" to  0.7000000000000001 and "min_fold_change" to  1.25 for domain 0 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.6000000000000001 and "min_fold_change" to  1.125 for domain 0 to find at least 1 SVG.
SVGs for domain  0 : ['ENSG00000109846', 'ENSG00000168314', 'ENSG00000160307', 'ENSG00000091513', 'ENSG00000105695']
Add gene:  ENSG00000131095
Minus gene:  ENSG00000154146
Absolute mean change: 1.6951902
Number of non-target spots reduced to: 1611
===========================================================================
Meta gene is:  ENSG00000109846+ENSG00000131095-ENSG00000154146
===========================================================================
Add gene:  ENSG00000118785
Minus gene:  ENSG00000198938
Absolute mean change: 2.8685722
Number of non-target spots reduced to: 33
===========================================================================
Meta gene is:  ENSG00000109846+ENSG00000131095-ENSG00000154146+ENSG00000118785-ENSG00000198938
===========================================================================
Meta gene is:  ENSG00000109846+ENSG00000131095-ENSG00000154146+ENSG00000118785-ENSG00000198938
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [1.4142135381698608, 17.0880069732666], num_nbr [1.0, 440.8314606741573]
Calculateing adj matrix using xy only...
Run 2: radius [1.4142135381698608, 9.251110255718231], num_nbr [1.0, 135.03210272873193]
Calculateing adj matrix using xy only...
Run 3: radius [1.4142135381698608, 5.332661896944046], num_nbr [1.0, 44.637239165329056]
Calculateing adj matrix using xy only...
Run 4: radius [1.4142135381698608, 3.3734377175569534], num_nbr [1.0, 20.88282504012841]
Calculateing adj matrix using xy only...
Run 5: radius [2.393825627863407, 3.3734377175569534], num_nbr [8.969502407704654, 20.88282504012841]
Calculateing adj matrix using xy only...
recommended radius =  2.8836316727101803 num_nbr=12.940609951845907
radius= 2.8836316727101803 average number of neighbors for each spot is 12.940609951845907
 Cluster 1 has neighbors:
Dmain  5 :  1051
Dmain  7 :  1037
Dmain  0 :  999
Dmain  3 :  436
SVGs for domain  1 : ['ENSG00000154146', 'ENSG00000132639', 'ENSG00000185883', 'ENSG00000154096', 'ENSG00000187094', 'ENSG00000171617', 'ENSG00000171246']
Add gene:  ENSG00000128422
Minus gene:  ENSG00000198712
Absolute mean change: 0.51199794
Number of non-target spots reduced to: 1381
===========================================================================
Meta gene is:  ENSG00000154146+ENSG00000128422-ENSG00000198712
===========================================================================
Add gene:  ENSG00000282885
Minus gene:  ENSG00000128422
Stopped! Previous Number of non-target spots 1381 556 0.51199794 0.48393297
Previous Number of non-target spots 1381 556 0.51199794 0.48393297
Previous Number of non-target spots 1381
Current Number of non-target spots 556
Absolute mean change 0.51199794
===========================================================================
Meta gene:  ENSG00000154146+ENSG00000128422-ENSG00000198712
===========================================================================
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [1.4142135381698608, 17.0880069732666], num_nbr [1.0, 311.66281310211946]
Calculateing adj matrix using xy only...
Run 2: radius [1.4142135381698608, 9.251110255718231], num_nbr [1.0, 109.55491329479769]
Calculateing adj matrix using xy only...
Run 3: radius [1.4142135381698608, 5.332661896944046], num_nbr [1.0, 39.52215799614643]
Calculateing adj matrix using xy only...
Run 4: radius [1.4142135381698608, 3.3734377175569534], num_nbr [1.0, 19.22543352601156]
Calculateing adj matrix using xy only...
Run 5: radius [2.393825627863407, 3.3734377175569534], num_nbr [8.541425818882466, 19.22543352601156]
Calculateing adj matrix using xy only...
recommended radius =  2.8836316727101803 num_nbr=12.102119460500964
radius= 2.8836316727101803 average number of neighbors for each spot is 12.102119460500964
 Cluster 2 has neighbors:
Dmain  4 :  1971
Dmain  5 :  589
Dmain  7 :  579
Dmain  3 :  470
Warning: lowering "min_in_group_fraction" to  0.7000000000000001 and "min_fold_change" to  1.25 for domain 2 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.6000000000000001 and "min_fold_change" to  1.125 for domain 2 to find at least 1 SVG.
SVGs for domain  2 : ['ENSG00000198786', 'ENSG00000228253']
Add gene:  ENSG00000228253
Minus gene:  ENSG00000132639
Absolute mean change: 0.69014263
Number of non-target spots reduced to: 821
===========================================================================
Meta gene is:  ENSG00000198786+ENSG00000228253-ENSG00000132639
===========================================================================
Add gene:  ENSG00000198888
Minus gene:  ENSG00000197971
Absolute mean change: 1.5020487
Number of non-target spots reduced to: 671
===========================================================================
Meta gene is:  ENSG00000198786+ENSG00000228253-ENSG00000132639+ENSG00000198888-ENSG00000197971
===========================================================================
Add gene:  ENSG00000135821
Minus gene:  ENSG00000228253
Stopped! Previous Number of non-target spots 671 299 1.5020487 1.4999864
Previous Number of non-target spots 671 299 1.5020487 1.4999864
Previous Number of non-target spots 671
Current Number of non-target spots 299
Absolute mean change 1.5020487
===========================================================================
Meta gene:  ENSG00000198786+ENSG00000228253-ENSG00000132639+ENSG00000198888-ENSG00000197971
===========================================================================
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [1.4142135381698608, 17.0880069732666], num_nbr [1.0, 393.577868852459]
Calculateing adj matrix using xy only...
Run 2: radius [1.4142135381698608, 9.251110255718231], num_nbr [1.0, 128.2172131147541]
Calculateing adj matrix using xy only...
Run 3: radius [1.4142135381698608, 5.332661896944046], num_nbr [1.0, 43.63934426229508]
Calculateing adj matrix using xy only...
Run 4: radius [1.4142135381698608, 3.3734377175569534], num_nbr [1.0, 20.69672131147541]
Calculateing adj matrix using xy only...
Run 5: radius [2.393825627863407, 3.3734377175569534], num_nbr [8.94672131147541, 20.69672131147541]
Calculateing adj matrix using xy only...
recommended radius =  2.8836316727101803 num_nbr=12.87704918032787
radius= 2.8836316727101803 average number of neighbors for each spot is 12.87704918032787
 Cluster 3 has neighbors:
Dmain  7 :  639
Dmain  5 :  497
Dmain  2 :  470
Dmain  4 :  443
Dmain  1 :  436
Can't find any genes such that more spots in domain 3 express the gene than its neighbors!
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [1.4142135381698608, 17.0880069732666], num_nbr [1.0, 326.4131534569983]
Calculateing adj matrix using xy only...
Run 2: radius [1.4142135381698608, 9.251110255718231], num_nbr [1.0, 114.24789207419899]
Calculateing adj matrix using xy only...
Run 3: radius [1.4142135381698608, 5.332661896944046], num_nbr [1.0, 40.72344013490725]
Calculateing adj matrix using xy only...
Run 4: radius [1.4142135381698608, 3.3734377175569534], num_nbr [1.0, 19.617200674536257]
Calculateing adj matrix using xy only...
Run 5: radius [2.393825627863407, 3.3734377175569534], num_nbr [8.661045531197303, 19.617200674536257]
Calculateing adj matrix using xy only...
recommended radius =  2.8836316727101803 num_nbr=12.313659359190556
radius= 2.8836316727101803 average number of neighbors for each spot is 12.313659359190556
 Cluster 4 has neighbors:
Dmain  2 :  1971
Dmain  7 :  654
Dmain  3 :  443
Dmain  5 :  413
Warning: lowering "min_in_group_fraction" to  0.7000000000000001 and "min_fold_change" to  1.25 for domain 4 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.6000000000000001 and "min_fold_change" to  1.125 for domain 4 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.5000000000000001 and "min_fold_change" to  1.0625 for domain 4 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.40000000000000013 and "min_fold_change" to  1.03125 for domain 4 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.30000000000000016 and "min_fold_change" to  1.015625 for domain 4 to find at least 1 SVG.
No "fold_change" > 1.01 exists that finds any SVGs for domain 4!
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [1.4142135381698608, 17.0880069732666], num_nbr [1.0, 390.2420537897311]
Calculateing adj matrix using xy only...
Run 2: radius [1.4142135381698608, 9.251110255718231], num_nbr [1.0, 125.83374083129584]
Calculateing adj matrix using xy only...
Run 3: radius [1.4142135381698608, 5.332661896944046], num_nbr [1.0, 42.84107579462103]
Calculateing adj matrix using xy only...
Run 4: radius [1.4142135381698608, 3.3734377175569534], num_nbr [1.0, 20.25427872860636]
Calculateing adj matrix using xy only...
Run 5: radius [2.393825627863407, 3.3734377175569534], num_nbr [8.765281173594133, 20.25427872860636]
Calculateing adj matrix using xy only...
recommended radius =  2.8836316727101803 num_nbr=12.601466992665037
radius= 2.8836316727101803 average number of neighbors for each spot is 12.601466992665037
 Cluster 5 has neighbors:
Dmain  1 :  1051
Dmain  7 :  833
Dmain  2 :  589
Dmain  3 :  497
Dmain  4 :  413
Warning: lowering "min_in_group_fraction" to  0.7000000000000001 and "min_fold_change" to  1.25 for domain 5 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.6000000000000001 and "min_fold_change" to  1.125 for domain 5 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.5000000000000001 and "min_fold_change" to  1.0625 for domain 5 to find at least 1 SVG.
SVGs for domain  5 : ['ENSG00000269028']
Add gene:  ENSG00000164116
Minus gene:  ENSG00000154146
Absolute mean change: 0.26360178
Number of non-target spots reduced to: 1416
===========================================================================
Meta gene is:  ENSG00000269028+ENSG00000164116-ENSG00000154146
===========================================================================
Add gene:  ENSG00000154146
Minus gene:  ENSG00000105695
Absolute mean change: 0.46163726
Number of non-target spots reduced to: 1069
===========================================================================
Meta gene is:  ENSG00000269028+ENSG00000164116-ENSG00000154146+ENSG00000154146-ENSG00000105695
===========================================================================
Add gene:  ENSG00000105695
Minus gene:  ENSG00000111640
Stopped! Previous Number of non-target spots 1069 1249 0.46163726 0.34782577
Previous Number of non-target spots 1069 1249 0.46163726 0.34782577
Previous Number of non-target spots 1069
Current Number of non-target spots 1249
Absolute mean change 0.46163726
===========================================================================
Meta gene:  ENSG00000269028+ENSG00000164116-ENSG00000154146+ENSG00000154146-ENSG00000105695
===========================================================================
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [1.4142135381698608, 17.0880069732666], num_nbr [1.0, 415.859410430839]
Calculateing adj matrix using xy only...
Run 2: radius [1.4142135381698608, 9.251110255718231], num_nbr [1.0, 132.24489795918367]
Calculateing adj matrix using xy only...
Run 3: radius [1.4142135381698608, 5.332661896944046], num_nbr [1.0, 44.31292517006803]
Calculateing adj matrix using xy only...
Run 4: radius [1.4142135381698608, 3.3734377175569534], num_nbr [1.0, 20.825396825396826]
Calculateing adj matrix using xy only...
Run 5: radius [2.393825627863407, 3.3734377175569534], num_nbr [8.961451247165533, 20.825396825396826]
Calculateing adj matrix using xy only...
recommended radius =  2.8836316727101803 num_nbr=12.922902494331066
radius= 2.8836316727101803 average number of neighbors for each spot is 12.922902494331066
 Cluster 7 has neighbors:
Dmain  1 :  1037
Dmain  5 :  833
Dmain  4 :  654
Dmain  3 :  639
Dmain  2 :  579
Warning: lowering "min_in_group_fraction" to  0.7000000000000001 and "min_fold_change" to  1.25 for domain 7 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.6000000000000001 and "min_fold_change" to  1.125 for domain 7 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.5000000000000001 and "min_fold_change" to  1.0625 for domain 7 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.40000000000000013 and "min_fold_change" to  1.03125 for domain 7 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.30000000000000016 and "min_fold_change" to  1.015625 for domain 7 to find at least 1 SVG.
No "fold_change" > 1.01 exists that finds any SVGs for domain 7!
