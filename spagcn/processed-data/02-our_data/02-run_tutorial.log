Loading LIBD module for spagcn/1.2.0
Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
Trying to set attribute `.obs` of view, copying.
Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Calculateing adj matrix using histology image...
Var of c0,c1,c2 =  29.491026128375946 134.2952645407559 40.147192329431
Var of x,y,z =  6252707.229989054 5320962.767835974 6252707.229989053
Run 1: l [0.01, 1000], p [0.0, 148.17622003674612]
Run 2: l [0.01, 500.005], p [0.0, 25.914703369140625]
Run 3: l [0.01, 250.0075], p [0.0, 3.802572727203369]
Run 4: l [125.00874999999999, 250.0075], p [0.45451271533966064, 3.802572727203369]
Run 5: l [125.00874999999999, 187.508125], p [0.45451271533966064, 1.630110263824463]
Run 6: l [125.00874999999999, 156.2584375], p [0.45451271533966064, 0.9327691793441772]
Run 7: l [125.00874999999999, 140.63359375], p [0.45451271533966064, 0.6682571172714233]
Run 8: l [125.00874999999999, 132.821171875], p [0.45451271533966064, 0.5552898645401001]
recommended l =  128.91496093749998
Start at res =  0.7 step =  0.1
Initializing cluster centers with louvain, resolution =  0.7
Epoch  0
Epoch  10
Res =  0.7 Num of clusters =  6
Initializing cluster centers with louvain, resolution =  0.7999999999999999
Epoch  0
Epoch  10
Res =  0.7999999999999999 Num of clusters =  6
Res changed to 0.7999999999999999
Initializing cluster centers with louvain, resolution =  0.8999999999999999
Epoch  0
Epoch  10
Res =  0.8999999999999999 Num of clusters =  7
recommended res =  0.8999999999999999
Initializing cluster centers with louvain, resolution =  0.8999999999999999
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [2.0, 18.0], num_nbr [8.73838630806846, 399.98899755501225]
Calculateing adj matrix using xy only...
Run 2: radius [2.0, 10.0], num_nbr [8.73838630806846, 140.7200488997555]
Calculateing adj matrix using xy only...
Run 3: radius [2.0, 6.0], num_nbr [8.73838630806846, 56.140586797066014]
Calculateing adj matrix using xy only...
Run 4: radius [2.0, 4.0], num_nbr [8.73838630806846, 23.74083129584352]
Calculateing adj matrix using xy only...
recommended radius =  3.0 num_nbr=12.493887530562347
radius= 3.0 average number of neighbors for each spot is 12.493887530562347
 Cluster 0 has neighbors:
Dmain  2 :  560
SVGs for domain  0 : ['ENSG00000131095']
Add gene:  ENSG00000162545
Minus gene:  ENSG00000131095
Absolute mean change: 0.695873
Number of non-target spots reduced to: 2532
===========================================================================
Meta gene is:  ENSG00000131095+ENSG00000162545-ENSG00000131095
===========================================================================
Add gene:  ENSG00000115756
Minus gene:  ENSG00000197971
Absolute mean change: 1.8458784
Number of non-target spots reduced to: 356
===========================================================================
Meta gene is:  ENSG00000131095+ENSG00000162545-ENSG00000131095+ENSG00000115756-ENSG00000197971
===========================================================================
Add gene:  ENSG00000150625
Minus gene:  ENSG00000131095
Absolute mean change: 2.639102
Number of non-target spots reduced to: 145
===========================================================================
Meta gene is:  ENSG00000131095+ENSG00000162545-ENSG00000131095+ENSG00000115756-ENSG00000197971+ENSG00000150625-ENSG00000131095
===========================================================================
