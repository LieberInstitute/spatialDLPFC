Loading LIBD module for spagcn/1.2.0
Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
Trying to set attribute `.obs` of view, copying.
Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Trying to set attribute `.obs` of view, copying.
WARNING: It seems you use rank_genes_groups on the raw count data. Please logarithmize your data before calling rank_genes_groups.
Continuing with sample Br2720_ant_2...
Calculateing adj matrix using histology image...
Var of c0,c1,c2 =  472.24958850945086 816.7568185776488 306.41326107713695
Var of x,y,z =  16359429.771732071 19405449.778997753 19405449.778997757
Run 1: l [0.01, 1000], p [0.0, 25.59083857951292]
Run 2: l [0.01, 500.005], p [0.0, 3.7630929946899414]
Run 3: l [250.0075, 500.005], p [0.4687657356262207, 3.7630929946899414]
Run 4: l [250.0075, 375.00625], p [0.4687657356262207, 1.629424810409546]
Run 5: l [250.0075, 312.50687500000004], p [0.4687657356262207, 0.9425747394561768]
Run 6: l [250.0075, 281.2571875], p [0.4687657356262207, 0.6811124086380005]
Run 7: l [250.0075, 265.63234375], p [0.4687657356262207, 0.5690677165985107]
Run 8: l [250.0075, 257.819921875], p [0.4687657356262207, 0.5174828767776489]
recommended l =  253.91371093749999
Start at res =  0.7 step =  0.1
Initializing cluster centers with louvain, resolution =  0.7
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  0.7 Num of clusters =  4
Initializing cluster centers with louvain, resolution =  0.7999999999999999
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  0.7999999999999999 Num of clusters =  5
Res changed to 0.7999999999999999
Initializing cluster centers with louvain, resolution =  0.8999999999999999
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  0.8999999999999999 Num of clusters =  5
Res changed to 0.8999999999999999
Initializing cluster centers with louvain, resolution =  0.9999999999999999
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  0.9999999999999999 Num of clusters =  5
Res changed to 0.9999999999999999
Initializing cluster centers with louvain, resolution =  1.0999999999999999
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  1.0999999999999999 Num of clusters =  9
Step changed to 0.05
Initializing cluster centers with louvain, resolution =  1.0499999999999998
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  1.0499999999999998 Num of clusters =  5
Res changed to 1.0499999999999998
Initializing cluster centers with louvain, resolution =  1.0999999999999999
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  1.0999999999999999 Num of clusters =  9
Step changed to 0.025
Initializing cluster centers with louvain, resolution =  1.0749999999999997
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  1.0749999999999997 Num of clusters =  8
Step changed to 0.0125
Initializing cluster centers with louvain, resolution =  1.0624999999999998
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  1.0624999999999998 Num of clusters =  6
Res changed to 1.0624999999999998
Initializing cluster centers with louvain, resolution =  1.0749999999999997
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  1.0749999999999997 Num of clusters =  8
Step changed to 0.00625
Initializing cluster centers with louvain, resolution =  1.0687499999999999
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  1.0687499999999999 Num of clusters =  8
Step changed to 0.003125
Initializing cluster centers with louvain, resolution =  1.0656249999999998
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  1.0656249999999998 Num of clusters =  8
Step changed to 0.0015625
Initializing cluster centers with louvain, resolution =  1.0640624999999997
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Res =  1.0640624999999997 Num of clusters =  7
recommended res =  1.0640624999999997
Initializing cluster centers with louvain, resolution =  1.0640624999999997
Epoch  0
Epoch  10
Epoch  20
Epoch  30
Epoch  40
Epoch  50
Epoch  60
Epoch  70
Epoch  80
Epoch  90
Epoch  100
Epoch  110
Epoch  120
Epoch  130
Epoch  140
Epoch  150
Epoch  160
Epoch  170
Epoch  180
Epoch  190
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [1.4142135381698608, 15.620499610900879], num_nbr [1.0, 286.93072625698323]
Calculateing adj matrix using xy only...
Run 2: radius [1.4142135381698608, 8.51735657453537], num_nbr [1.0, 93.90502793296089]
Calculateing adj matrix using xy only...
Run 3: radius [1.4142135381698608, 4.965785056352615], num_nbr [1.0, 32.58324022346369]
Calculateing adj matrix using xy only...
Run 4: radius [1.4142135381698608, 3.189999297261238], num_nbr [1.0, 18.979888268156426]
Calculateing adj matrix using xy only...
Run 5: radius [2.3021064177155495, 3.189999297261238], num_nbr [8.406703910614524, 18.979888268156426]
Calculateing adj matrix using xy only...
Run 6: radius [2.746052857488394, 3.189999297261238], num_nbr [8.406703910614524, 18.979888268156426]
Calculateing adj matrix using xy only...
recommended radius =  2.968026077374816 num_nbr=11.937430167597766
radius= 2.968026077374816 average number of neighbors for each spot is 11.937430167597766
 Cluster 0 has neighbors:
Dmain  1 :  1828
Dmain  6 :  962
Dmain  3 :  950
Dmain  2 :  833
Dmain  5 :  475
Dmain  4 :  387
Warning: lowering "min_in_group_fraction" to  0.7000000000000001 and "min_fold_change" to  1.25 for domain 0 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.6000000000000001 and "min_fold_change" to  1.125 for domain 0 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.5000000000000001 and "min_fold_change" to  1.0625 for domain 0 to find at least 1 SVG.
SVGs for domain  0 : ['ENSG00000198763', 'ENSG00000269028']
Add gene:  ENSG00000131095
Minus gene:  ENSG00000132639
Absolute mean change: 0.6724293
Number of non-target spots reduced to: 1319
===========================================================================
Meta gene is:  ENSG00000198763+ENSG00000131095-ENSG00000132639
===========================================================================
Add gene:  ENSG00000282885
Minus gene:  ENSG00000154146
Absolute mean change: 1.2051828
Number of non-target spots reduced to: 528
===========================================================================
Meta gene is:  ENSG00000198763+ENSG00000131095-ENSG00000132639+ENSG00000282885-ENSG00000154146
===========================================================================
Add gene:  ENSG00000269028
Minus gene:  ENSG00000080824
Absolute mean change: 1.6122117
Number of non-target spots reduced to: 340
===========================================================================
Meta gene is:  ENSG00000198763+ENSG00000131095-ENSG00000132639+ENSG00000282885-ENSG00000154146+ENSG00000269028-ENSG00000080824
===========================================================================
Warning: dropping one or more meta genes for this domain when forming CSV, since we are only taking the first 5.
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [1.4142135381698608, 15.620499610900879], num_nbr [1.0, 343.46702127659574]
Calculateing adj matrix using xy only...
Run 2: radius [1.4142135381698608, 8.51735657453537], num_nbr [1.0, 107.32872340425531]
Calculateing adj matrix using xy only...
Run 3: radius [1.4142135381698608, 4.965785056352615], num_nbr [1.0, 36.064893617021276]
Calculateing adj matrix using xy only...
Run 4: radius [1.4142135381698608, 3.189999297261238], num_nbr [1.0, 20.628723404255318]
Calculateing adj matrix using xy only...
Run 5: radius [2.3021064177155495, 3.189999297261238], num_nbr [8.91595744680851, 20.628723404255318]
Calculateing adj matrix using xy only...
Run 6: radius [2.746052857488394, 3.189999297261238], num_nbr [8.91595744680851, 20.628723404255318]
Calculateing adj matrix using xy only...
recommended radius =  2.968026077374816 num_nbr=12.820212765957447
radius= 2.968026077374816 average number of neighbors for each spot is 12.820212765957447
 Cluster 1 has neighbors:
Dmain  0 :  1828
Dmain  3 :  1687
Dmain  2 :  1195
Dmain  6 :  818
Dmain  5 :  588
Dmain  4 :  543
Can't find any genes such that more spots in domain 1 express the gene than its neighbors!
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [1.4142135381698608, 15.620499610900879], num_nbr [1.0, 337.93225806451613]
Calculateing adj matrix using xy only...
Run 2: radius [1.4142135381698608, 8.51735657453537], num_nbr [1.0, 105.90645161290323]
Calculateing adj matrix using xy only...
Run 3: radius [1.4142135381698608, 4.965785056352615], num_nbr [1.0, 35.66129032258065]
Calculateing adj matrix using xy only...
Run 4: radius [1.4142135381698608, 3.189999297261238], num_nbr [1.0, 20.483870967741936]
Calculateing adj matrix using xy only...
Run 5: radius [2.3021064177155495, 3.189999297261238], num_nbr [8.896774193548387, 20.483870967741936]
Calculateing adj matrix using xy only...
Run 6: radius [2.746052857488394, 3.189999297261238], num_nbr [8.896774193548387, 20.483870967741936]
Calculateing adj matrix using xy only...
recommended radius =  2.968026077374816 num_nbr=12.76774193548387
radius= 2.968026077374816 average number of neighbors for each spot is 12.76774193548387
 Cluster 2 has neighbors:
Dmain  1 :  1195
Dmain  0 :  833
Dmain  3 :  467
Dmain  6 :  320
Dmain  4 :  195
Dmain  5 :  186
Warning: lowering "min_in_group_fraction" to  0.7000000000000001 and "min_fold_change" to  1.25 for domain 2 to find at least 1 SVG.
SVGs for domain  2 : ['ENSG00000198840']
Add gene:  ENSG00000166165
Minus gene:  ENSG00000034510
Absolute mean change: 0.892436
Number of non-target spots reduced to: 1107
===========================================================================
Meta gene is:  ENSG00000198840+ENSG00000166165-ENSG00000034510
===========================================================================
Add gene:  ENSG00000087250
Minus gene:  ENSG00000166165
Stopped! Previous Number of non-target spots 1107 466 0.892436 0.8652489
Previous Number of non-target spots 1107 466 0.892436 0.8652489
Previous Number of non-target spots 1107
Current Number of non-target spots 466
Absolute mean change 0.892436
===========================================================================
Meta gene:  ENSG00000198840+ENSG00000166165-ENSG00000034510
===========================================================================
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [1.4142135381698608, 15.620499610900879], num_nbr [1.0, 327.4831730769231]
Calculateing adj matrix using xy only...
Run 2: radius [1.4142135381698608, 8.51735657453537], num_nbr [1.0, 102.93990384615384]
Calculateing adj matrix using xy only...
Run 3: radius [1.4142135381698608, 4.965785056352615], num_nbr [1.0, 34.78125]
Calculateing adj matrix using xy only...
Run 4: radius [1.4142135381698608, 3.189999297261238], num_nbr [1.0, 19.963942307692307]
Calculateing adj matrix using xy only...
Run 5: radius [2.3021064177155495, 3.189999297261238], num_nbr [8.701923076923077, 19.963942307692307]
Calculateing adj matrix using xy only...
Run 6: radius [2.746052857488394, 3.189999297261238], num_nbr [8.701923076923077, 19.963942307692307]
Calculateing adj matrix using xy only...
recommended radius =  2.968026077374816 num_nbr=12.44951923076923
radius= 2.968026077374816 average number of neighbors for each spot is 12.44951923076923
 Cluster 3 has neighbors:
Dmain  1 :  1687
Dmain  0 :  950
Dmain  2 :  467
Dmain  6 :  416
Dmain  4 :  250
Dmain  5 :  239
Can't find any genes such that more spots in domain 3 express the gene than its neighbors!
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [1.4142135381698608, 15.620499610900879], num_nbr [1.0, 328.8380281690141]
Calculateing adj matrix using xy only...
Run 2: radius [1.4142135381698608, 8.51735657453537], num_nbr [1.0, 104.53521126760563]
Calculateing adj matrix using xy only...
Run 3: radius [1.4142135381698608, 4.965785056352615], num_nbr [1.0, 35.53521126760563]
Calculateing adj matrix using xy only...
Run 4: radius [1.4142135381698608, 3.189999297261238], num_nbr [1.0, 20.41549295774648]
Calculateing adj matrix using xy only...
Run 5: radius [2.3021064177155495, 3.189999297261238], num_nbr [8.845070422535212, 20.41549295774648]
Calculateing adj matrix using xy only...
Run 6: radius [2.746052857488394, 3.189999297261238], num_nbr [8.845070422535212, 20.41549295774648]
Calculateing adj matrix using xy only...
recommended radius =  2.968026077374816 num_nbr=12.725352112676056
radius= 2.968026077374816 average number of neighbors for each spot is 12.725352112676056
 Cluster 4 has neighbors:
Dmain  1 :  543
Dmain  3 :  250
Dmain  2 :  195
Dmain  5 :  88
Warning: lowering "min_in_group_fraction" to  0.7000000000000001 and "min_fold_change" to  1.25 for domain 4 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.6000000000000001 and "min_fold_change" to  1.125 for domain 4 to find at least 1 SVG.
SVGs for domain  4 : ['ENSG00000198899', 'ENSG00000198886']
Add gene:  ENSG00000256618
Minus gene:  ENSG00000198899
Absolute mean change: 0.13495608
Number of non-target spots reduced to: 1011
===========================================================================
Meta gene is:  ENSG00000198899+ENSG00000256618-ENSG00000198899
===========================================================================
Add gene:  ENSG00000034510
Minus gene:  ENSG00000256618
Absolute mean change: 0.14478329
Number of non-target spots reduced to: 850
===========================================================================
Meta gene is:  ENSG00000198899+ENSG00000256618-ENSG00000198899+ENSG00000034510-ENSG00000256618
===========================================================================
Add gene:  ENSG00000198886
Minus gene:  ENSG00000034510
Stopped! Previous Number of non-target spots 850 1291 0.14478329 0.28015232
Previous Number of non-target spots 850 1291 0.14478329 0.28015232
Previous Number of non-target spots 850
Current Number of non-target spots 1291
Absolute mean change 0.14478329
===========================================================================
Meta gene:  ENSG00000198899+ENSG00000256618-ENSG00000198899+ENSG00000034510-ENSG00000256618
===========================================================================
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [1.4142135381698608, 15.620499610900879], num_nbr [1.0, 314.36526946107784]
Calculateing adj matrix using xy only...
Run 2: radius [1.4142135381698608, 8.51735657453537], num_nbr [1.0, 99.48502994011976]
Calculateing adj matrix using xy only...
Run 3: radius [1.4142135381698608, 4.965785056352615], num_nbr [1.0, 34.053892215568865]
Calculateing adj matrix using xy only...
Run 4: radius [1.4142135381698608, 3.189999297261238], num_nbr [1.0, 19.664670658682635]
Calculateing adj matrix using xy only...
Run 5: radius [2.3021064177155495, 3.189999297261238], num_nbr [8.616766467065869, 19.664670658682635]
Calculateing adj matrix using xy only...
Run 6: radius [2.746052857488394, 3.189999297261238], num_nbr [8.616766467065869, 19.664670658682635]
Calculateing adj matrix using xy only...
recommended radius =  2.968026077374816 num_nbr=12.323353293413174
radius= 2.968026077374816 average number of neighbors for each spot is 12.323353293413174
 Cluster 5 has neighbors:
Dmain  1 :  588
Dmain  0 :  475
Dmain  3 :  239
Dmain  6 :  203
Dmain  2 :  186
Dmain  4 :  88
Warning: lowering "min_in_group_fraction" to  0.7000000000000001 and "min_fold_change" to  1.25 for domain 5 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.6000000000000001 and "min_fold_change" to  1.125 for domain 5 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.5000000000000001 and "min_fold_change" to  1.0625 for domain 5 to find at least 1 SVG.
SVGs for domain  5 : ['ENSG00000198668', 'ENSG00000198786', 'ENSG00000080824']
Add gene:  ENSG00000198786
Minus gene:  ENSG00000034510
Absolute mean change: 0.5296562
Number of non-target spots reduced to: 1581
===========================================================================
Meta gene is:  ENSG00000198668+ENSG00000198786-ENSG00000034510
===========================================================================
Add gene:  ENSG00000080824
Minus gene:  ENSG00000198899
Absolute mean change: 0.98058605
Number of non-target spots reduced to: 882
===========================================================================
Meta gene is:  ENSG00000198668+ENSG00000198786-ENSG00000034510+ENSG00000080824-ENSG00000198899
===========================================================================
Add gene:  ENSG00000182899
Minus gene:  ENSG00000198840
Absolute mean change: 1.4155519
Number of non-target spots reduced to: 502
===========================================================================
Meta gene is:  ENSG00000198668+ENSG00000198786-ENSG00000034510+ENSG00000080824-ENSG00000198899+ENSG00000182899-ENSG00000198840
===========================================================================
Warning: dropping one or more meta genes for this domain when forming CSV, since we are only taking the first 5.
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Calculateing adj matrix using xy only...
Run 1: radius [1.4142135381698608, 15.620499610900879], num_nbr [1.0, 290.36700336700335]
Calculateing adj matrix using xy only...
Run 2: radius [1.4142135381698608, 8.51735657453537], num_nbr [1.0, 92.6026936026936]
Calculateing adj matrix using xy only...
Run 3: radius [1.4142135381698608, 4.965785056352615], num_nbr [1.0, 31.781144781144782]
Calculateing adj matrix using xy only...
Run 4: radius [1.4142135381698608, 3.189999297261238], num_nbr [1.0, 18.5016835016835]
Calculateing adj matrix using xy only...
Run 5: radius [2.3021064177155495, 3.189999297261238], num_nbr [8.265993265993266, 18.5016835016835]
Calculateing adj matrix using xy only...
Run 6: radius [2.746052857488394, 3.189999297261238], num_nbr [8.265993265993266, 18.5016835016835]
Calculateing adj matrix using xy only...
recommended radius =  2.968026077374816 num_nbr=11.683501683501683
radius= 2.968026077374816 average number of neighbors for each spot is 11.683501683501683
 Cluster 6 has neighbors:
Dmain  0 :  962
Dmain  1 :  818
Dmain  3 :  416
Dmain  2 :  320
Dmain  5 :  203
Dmain  4 :  120
Warning: lowering "min_in_group_fraction" to  0.7000000000000001 and "min_fold_change" to  1.25 for domain 6 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.6000000000000001 and "min_fold_change" to  1.125 for domain 6 to find at least 1 SVG.
Warning: lowering "min_in_group_fraction" to  0.5000000000000001 and "min_fold_change" to  1.0625 for domain 6 to find at least 1 SVG.
SVGs for domain  6 : ['ENSG00000198786']
Add gene:  ENSG00000197971
Minus gene:  ENSG00000198840
Absolute mean change: 0.70663
Number of non-target spots reduced to: 1429
===========================================================================
Meta gene is:  ENSG00000198786+ENSG00000197971-ENSG00000198840
===========================================================================
Add gene:  ENSG00000198668
Minus gene:  ENSG00000034510
Absolute mean change: 1.0684357
Number of non-target spots reduced to: 738
===========================================================================
Meta gene is:  ENSG00000198786+ENSG00000197971-ENSG00000198840+ENSG00000198668-ENSG00000034510
===========================================================================
Add gene:  ENSG00000228253
Minus gene:  ENSG00000166165
Absolute mean change: 1.4783657
Number of non-target spots reduced to: 389
===========================================================================
Meta gene is:  ENSG00000198786+ENSG00000197971-ENSG00000198840+ENSG00000198668-ENSG00000034510+ENSG00000228253-ENSG00000166165
===========================================================================
Warning: dropping one or more meta genes for this domain when forming CSV, since we are only taking the first 5.
