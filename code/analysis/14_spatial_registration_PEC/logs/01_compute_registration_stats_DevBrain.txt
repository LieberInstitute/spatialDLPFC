Adding LIBD modules
Loading git
Loading LIBD module for git-status-size/github
Loading LIBD module for git-lfs/2.8.0
Loading LIBD module for rmate/1.5.9
Loading LIBD module for ruby/2.6.4p104
Loading conda_R/4.2
**** Job starts ****
Tue Sep 13 12:53:42 EDT 2022
**** JHPCE info ****
User: lhuuki
Job id: 1859779
Job name: compute_registration_stats_DevBrain
Hostname: compute-127.cm.cluster
Task id: undefined
Unloading conda_R/4.2
Loading conda_R/4.2

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV  11) ruby/2.6.4p104
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV      12) rmate/1.5.9
  3) JHPCE_tools/1.0   8) git-status-size/github         13) conda/3-4.11.0
  4) sge/8.1.9         9) git/2.28.0                     14) conda_R/4.2
  5) gcc/4.4.7        10) git-lfs/2.8.0

 

Loading required package: SummarizedExperiment
Loading required package: MatrixGenerics
Loading required package: matrixStats

Attaching package: ‘MatrixGenerics’

The following objects are masked from ‘package:matrixStats’:

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars

Loading required package: GenomicRanges
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    anyDuplicated, append, as.data.frame, basename, cbind, colnames,
    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,
    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,
    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,
    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,
    union, unique, unsplit, which.max, which.min

Loading required package: S4Vectors

Attaching package: ‘S4Vectors’

The following objects are masked from ‘package:base’:

    expand.grid, I, unname

Loading required package: IRanges
Loading required package: GenomeInfoDb
Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.


Attaching package: ‘Biobase’

The following object is masked from ‘package:MatrixGenerics’:

    rowMedians

The following objects are masked from ‘package:matrixStats’:

    anyMissing, rowMedians

Loading required package: SpatialExperiment
here() starts at /dcs04/lieber/lcolladotor/spatialDLPFC_LIBD4035/spatialDLPFC
Running -DevBrain
2022-09-13 12:54:04 - Reading data from: /dcs04/lieber/lcolladotor/spatialDLPFC_LIBD4035/spatialDLPFC/raw-data/psychENCODE/version2/DevBrain/DevBrain-snRNAseq_annotated.h5ad
Warning messages:
1: The names of these selected uns items have been modified to match R conventions: '_attr2type' -> 'X_attr2type' 
2: conversion failed for the item 'de_res' in 'varm' with the following error and has been skipped
Conversion error message: Error in py_ref_to_r(x): Conversion from numpy array type 20 is not supported
 

SCE Dimesions:
[1]  33201 108358
Cell Types:

     Astro Chandelier       Endo    L2.3.IT      L4.IT    L5.6.NP      L5.ET 
     12799        589       3974      22583       5036        772        218 
     L5.IT      L6.CT      L6.IT L6.IT.Car3        L6b      Lamp5 Lamp5.Lhx6 
      6754       2008       7129        936        961       1341        629 
 Micro.PVM      Oligo        OPC       Pax6      Pvalb       Sncg        Sst 
      3321      16185       5331        297       4191       1176       4005 
 Sst.Chodl        Vip       VLMC 
        35       3693       4395 
2022-09-13 12:55:33 make pseudobulk object
2022-09-13 12:57:09 drop lowly expressed genes
2022-09-13 12:57:10 normalize expression
2022-09-13 12:57:16 dropping 26 pseudo-bulked samples that are below 'min_ncells'.
2022-09-13 12:57:16 create model matrix
2022-09-13 12:57:16 run duplicateCorrelation()
Note: design matrix not of full rank (1 coef not estimable).
2022-09-13 12:59:17 computing enrichment statistics
Coefficients not estimable: res 
2022-09-13 13:00:05 extract and reformat enrichment results
2022-09-13 13:00:05 running the baseline pairwise model
Coefficients not estimable: Sst.Chodl 
2022-09-13 13:00:08 computing pairwise statistics
Error in limma::contrasts.fit(fit, regis_constrasts) : 
  trying to take contrast of non-estimable coefficient
Calls: registration_wrapper ... registration_stats_pairwise -> <Anonymous> -> .ebayes -> <Anonymous>
In addition: Warning messages:
1: Partial NA coefficients for 25991 probe(s) 
2: In .ebayes(fit = fit, proportion = proportion, stdev.coef.lim = stdev.coef.lim,  :
  Estimation of var.prior failed - set to default value
3: Partial NA coefficients for 25991 probe(s) 
4: In .ebayes(fit = fit, proportion = proportion, stdev.coef.lim = stdev.coef.lim,  :
  Estimation of var.prior failed - set to default value
Execution halted
**** Job ends ****
Tue Sep 13 13:00:10 EDT 2022
